"use strict";(self.webpackChunkkkts=self.webpackChunkkkts||[]).push([[9837],{99985:(n,a,e)=>{e.d(a,{A:()=>p});var t=e(82483),i=e(33713),o=e(79948),s=e(53397),r=e(27957),l=e(18682),c=e(18570),h=e(30180),d=e(54686),u=e.n(d),D=(e(94690),e(56723));const{Item:y}=o.A,p=n=>{const[a,e]=(0,t.useState)([]),{useForm:d}=o.A,[p]=d();(0,t.useEffect)((()=>{const{dataEdit:a}=n;a&&p&&p.setFieldsValue({...a,NgayTruc:a.NgayTruc?u()(a.NgayTruc):null})}),[]);const{confirmLoading:g,visible:A,onCancel:T,onPrint:f}=n;return(0,D.jsx)(l.A,{title:"D\xe2n kh\xf4ng \u0111\u1ebfn",width:i.MODAL_NORMAL,visible:A,onCancel:T,footer:[(0,D.jsx)(s.Ay,{onClick:T,children:"H\u1ee7y"},"back"),(0,D.jsx)(s.Ay,{loading:g,onClick:f,type:"primary",children:"L\u01b0u v\xe0 In"}),(0,D.jsx)(s.Ay,{loading:g,onClick:a=>{a.preventDefault(),p.validateFields().then((a=>{const e={...a};e.NgayTruc=(0,c.Yq)(e.NgayTruc);const{onCreate:t}=n;e.DanKhongDenID>0||delete e.DanKhongDenID,t(e)}))},type:"primary",children:"L\u01b0u"})],children:(0,D.jsxs)(o.A,{form:p,children:[(0,D.jsx)(y,{name:"DanKhongDenID",hidden:!0,children:(0,D.jsx)(r.A,{})}),(0,D.jsx)(y,{label:"Ng\xe0y ti\u1ebfp",name:"NgayTruc",...i.REQUIRED,...i.ITEM_LAYOUT,children:(0,D.jsx)(h.A,{style:{width:"100%"}})}),(0,D.jsx)(y,{label:"T\xean l\xe3nh \u0111\u1ea1o ti\u1ebfp d\xe2n",name:"TenCanBo",...i.REQUIRED,...i.ITEM_LAYOUT,children:(0,D.jsx)(r.A,{})}),(0,D.jsx)(y,{label:"Ch\u1ee9c v\u1ee5",name:"ChucVu",...i.ITEM_LAYOUT,children:(0,D.jsx)(r.A,{})})]})})}},87088:(n,a,e)=>{e.d(a,{A:()=>g});var t,i=e(57528),o=e(82483),s=e(79948),r=e(93445),l=e(23511),c=e(2370),h=(e(69973),e(22953)),d=(e(33713),e(65828)),u=(e(54686),e(18570),e(43047)),D=e(56723);const{Item:y}=s.A,p=h.Ay.div(t||(t=(0,i.A)(["\n  .radio-wrapper {\n    display: flex;\n    flex-direction: column;\n  }\n  iframe {\n    width: 100%;\n  }\n"]))),g=n=>{const[a,e]=(0,o.useState)(null),[t,i]=(0,o.useState)(!1),[s,h]=(0,o.useState)(!1),{dataEdit:y,XuLyDonID:g,TiepDanKhongDonID:A,DonThuID:T,title:f,visible:m,onCreate:S,fileKey:x,onCancel:I,DanhSachBieuMau:b}=n;(0,o.useEffect)((()=>{n.LoaiMaIn&&v(n.LoaiMaIn)}),[]);const v=n=>{u.A.GetPrevewPDF({MaPhieuIn:n,XuLyDonID:g,DonThuID:T,TiepDanKhongDonID:A}).then((n=>{n.data.Status>0?(h(n.data.Data),i(!0)):(r.Ay.destroy(),r.Ay.warning(n.data.Message))})).catch((n=>{r.Ay.destroy(),r.Ay.warning(n.toString())}))};return(0,D.jsx)(d.aF,{className:"center-modal__footer",title:"In phi\u1ebfu",visible:m,footer:(0,D.jsxs)(D.Fragment,{children:[a?(0,D.jsxs)(D.Fragment,{children:[t?null:(0,D.jsx)(c.A,{type:"primary",onClick:()=>v(a),children:"Xem tr\u01b0\u1edbc"}),t?(0,D.jsx)(c.A,{type:"primary",onClick:()=>i(!1),children:"Quay l\u1ea1i"}):(0,D.jsx)(c.A,{type:"primary",onClick:()=>{u.A.getChiTietBieuMau({MaPhieuIn:a,XuLyDonID:g,DonThuID:T,TiepDanKhongDonID:A}).then((n=>{if(n.data.Status>0){const a=document.createElement("a");a.href=n.data.Data,a.target="_blank",a.click()}else r.Ay.destroy(),r.Ay.warning(n.data.Message)})).catch((n=>{r.Ay.destroy(),r.Ay.warning(n.toString())}))},children:"T\u1ea3i file"})]}):null,(0,D.jsx)(c.A,{className:"btn-danger",onClick:()=>I(),children:"\u0110\xf3ng"})]}),width:1200,IsFullHeight:!0,onCancel:()=>I(),children:(0,D.jsx)(p,{children:t?(0,D.jsx)(D.Fragment,{children:(0,D.jsx)("iframe",{style:{height:800},src:s})}):(0,D.jsx)(l.Ay.Group,{className:"radio-wrapper",onChange:n=>e(n.target.value),value:a,children:b?b.map(((n,a)=>(0,D.jsx)(l.Ay,{className:"radio-items",value:n.MaPhieuIn,children:"".concat(a+1,". ").concat(n.TenBieuMau)}))):null})})})}},53923:(n,a,e)=>{e.r(a),e.d(a,{default:()=>j});var t,i=e(93445),o=e(65828),s=e(82483),r=e(82402),l=e(14739),c=e(53660),h=e(34045),d=e(81538),u=e(64684),D=(e(67353),e(53615),e(74405),e(69973),e(57528));const y=e(22953).Ay.div(t||(t=(0,D.A)(["\n  .ant-checkbox-wrapper {\n    /* display: inline-block; */\n    /* height: 16px; */\n  }\n  .ant-icon__table {\n    font-size: 14px;\n    align-items: center;\n    display: inline-block;\n  }\n\n  .ant-tabs-nav::before {\n    display: none !important;\n  }\n  .ant-tabs-nav-wrap div:first-child {\n    transform: none !important;\n  }\n  .ant-tabs-ink-bar {\n    display: none;\n  }\n  .ant-tabs-ink-bar-animated {\n    display: none;\n  }\n  .ant-tabs-nav {\n    margin-bottom: 0;\n  }\n  .ant-tabs-tab {\n    padding: 10px 0;\n  }\n  .ant-tabs .ant-tabs-tab {\n  }\n  .ant-tabs .ant-tabs-tab + .ant-tabs-tab {\n    margin: 0 !important;\n  }\n  .ant-tabs__title {\n    width: 200px;\n    /* height: 35px; */\n    background: #eaf1fb;\n    color: #000;\n    padding: 10px 0;\n    height: 36px;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    border-left: 1px solid #0b57d0;\n  }\n  .ant-tabs-tab-active .ant-tabs__title {\n    background: rgb(40, 120, 215) !important;\n    color: #fff;\n    background: #94cef7;\n    font-weight: 600;\n  }\n"])));var p=e(96328),g=(e(32870),e(54686),e(33713)),A=e(18570),T=e(67466),f=e(92378),m=e(22238),S=e(99985),x=(e(94690),e(5103),e(14486)),I=e(71126),b=e(87088),v=e(2637),L=e(56723);const j=(0,r.Ng)((function(n){return{...n.TiepDanThuongXuyen,role:(0,A.vh)(n.Auth.role,"tiep-thuong-xuyen")}}),l.A)((n=>{const a=n.location.pathname.toString().slice(n.location.pathname.lastIndexOf("/")+1),[e,t]=(0,s.useState)(f.parse(n.location.search)),[l,D]=(0,s.useState)({}),[j,F]=(0,T.D)(),[k,w]=(0,s.useState)(!0),[M,C]=(0,s.useState)(!1),[K,N]=(0,s.useState)([]),[E,P]=(0,s.useState)(!1),[X,_]=(0,s.useState)(0),[O,H]=(0,s.useState)(!1),[B,R]=(0,s.useState)(0),[U,Q]=(0,s.useState)(0),Y=(0,p.W6)(),G=(0,p.zy)(),z=(0,r.wA)(),{DanhSachLoaiKhieuTo:J,DanhSachQuocTich:V,DanhSachDanToc:q,DanhSachTinh:W,tableLoading:$}=n;(0,s.useEffect)((()=>{(0,A._Y)(e)}),[e]);(0,s.useEffect)((()=>{const a=G.pathname.slice(G.pathname.lastIndexOf("/")+1);let e=0;"tiep-thuong-xuyen"===a?e=g.LoaiTiepDan.ThuongXuyen:"tiep-dinh-ky"===a?e=g.LoaiTiepDan.DinhKy:"tiep-dot-xuat"===a&&(e=g.LoaiTiepDan.DotXuat),Q(e),n.getData()}),[]),(0,s.useEffect)((()=>{if(!$)if(Number(e.TiepDanKhongDonID)){const n=e.TiepDanKhongDonID;m.A.ChiTietDonThu({TiepDanID:n}).then((n=>{n.data.Status>0?(D(n.data.Data?{...n.data.Data,isReload:!0}:{}),F(),w(!1)):(i.Ay.destroy(),i.Ay.error(n.data.Message))})).catch((n=>{i.Ay.destroy(),i.Ay.error(n.toString())}))}else m.A.GetSTTHoSo().then((n=>{n.data.Status>0&&(D({SoDonThu:n.data.Data,isReload:!0}),F(),w(!1))}))}),[$]);const Z=()=>{D({}),F()};const nn=(n,a)=>{n?(Y.push("xu-ly-don-thu?isPrint=".concat(n,"&XuLyDonID=").concat(a)),z(I.A.changeCurrent("xu-ly-don-thu"))):(Y.push("xu-ly-don-thu"),z(I.A.changeCurrent("xu-ly-don-thu")))},an=()=>{P(!1)};return(0,L.jsxs)(c.A,{children:[(0,L.jsxs)(v.A,{children:[(0,L.jsx)(h.A,{children:(()=>{switch(n.location.pathname.toString().slice(n.location.pathname.lastIndexOf("/")+1)){case"tiep-thuong-xuyen":return document.title="Ti\u1ebfp th\u01b0\u1eddng xuy\xean","Ti\u1ebfp th\u01b0\u1eddng xuy\xean";case"tiep-dot-xuat":return document.title="Ti\u1ebfp \u0111\u1ed9t xu\u1ea5t","Ti\u1ebfp \u0111\u1ed9t xu\u1ea5t";case"tiep-dinh-ky":return document.title="Ti\u1ebfp \u0111\u1ecbnh k\u1ef3","Ti\u1ebfp \u0111\u1ecbnh k\u1ef3";default:return!1}})()}),(0,L.jsx)(d.A,{children:"tiep-dinh-ky"===a?(0,L.jsx)(o.$n,{type:"primary",className:"btn-center",onClick:()=>{_((n=>n+1)),P(!0)},children:"D\xe2n kh\xf4ng \u0111\u1ebfn"}):null})]}),(0,L.jsxs)(u.A,{isFullHeight:!0,children:[(0,L.jsx)(y,{}),(0,L.jsx)(x.A,{showThanhPhanTiepDan:(()=>{switch(n.location.pathname.toString().slice(n.location.pathname.lastIndexOf("/")+1)){case"tiep-thuong-xuyen":default:return!1;case"tiep-dot-xuat":case"tiep-dinh-ky":return!0}})(),dataEdit:l,loading:k,loadingSave:M,onCreate:async n=>{const a=Number(e.TiepDanKhongDonID),t=Number(e.XuLyDonID),o=Number(e.DonThuID);window.location.href.slice(0,window.location.href.lastIndexOf("/"));if(C(!0),a||t||o)if(n.XuLyDonID=t,n.TiepDanKhongDonID=a,n.DonThuID=o,n.DanhSachHoSoTaiLieu){const s=[];async function r(n,a){for(const o of n)if(!o.FileID){const n=new FormData;n.append("files",o),n.append("FileDinhKemStr",JSON.stringify({FileType:a.FileType,TenFile:(null===a||void 0===a?void 0:a.TenFile)||a.name}));try{const t=await m.A.UploadFile(n);var e;if(t.data.Status>0)a.DanhSachFileDinhKemID.push(null===(e=t.data.Data[0])||void 0===e?void 0:e.FileID),s.push(t.data.Data[0]);else C(!1),i.Ay.destroy(),i.Ay.warning(t.data.Data)}catch(t){console.error("Error uploading file:",t)}}}if(null!==n&&void 0!==n&&n.DanhSachHoSoTaiLieu)for(const l of n.DanhSachHoSoTaiLieu)l.DanhSachFileDinhKemID=[],null!==l&&void 0!==l&&l.FileDinhKem&&l&&await r(l.FileDinhKem,l);Promise.all(s).then((a=>{m.A.SuaDonThu({...n,LoaiTiepDanID:U}).then((a=>{C(!1),a.data.Status>0?(i.Ay.destroy(),i.Ay.success(a.data.Message),Z(),nn(null===n||void 0===n?void 0:n.isPrint,a.data.Data.XuLyDonID)):(i.Ay.destroy(),i.Ay.error("".concat(a.data.Message)))})).catch((n=>{i.Ay.destroy(),i.Ay.error("".concat(n.toString()))}))}))}else delete n.FileDinhKem,m.A.SuaDonThu({...n,LoaiTiepDanID:U}).then((a=>{C(!1),a.data.Status>0?(i.Ay.destroy(),i.Ay.success(a.data.Message),Z(),nn(null===n||void 0===n?void 0:n.isPrint,a.data.Data.XuLyDonID)):(i.Ay.destroy(),i.Ay.error("".concat(a.data.Message)))})).catch((n=>{i.Ay.destroy(),i.Ay.error("".concat(n.toString()))}));else if(n.DanhSachHoSoTaiLieu){const c=[];async function h(n,a){for(const o of n)if(!o.FileID){const n=new FormData;n.append("files",o),n.append("FileDinhKemStr",JSON.stringify({FileType:a.FileType,TenFile:(null===a||void 0===a?void 0:a.TenFile)||a.name}));try{const t=await m.A.UploadFile(n);var e;if(t.data.Status>0)a.DanhSachFileDinhKemID.push(null===(e=t.data.Data[0])||void 0===e?void 0:e.FileID),c.push(t.data.Data[0]);else C(!1),i.Ay.destroy(),i.Ay.warning(t.data.Data)}catch(t){console.error("Error uploading file:",t)}}}if(null!==n&&void 0!==n&&n.DanhSachHoSoTaiLieu)for(const d of n.DanhSachHoSoTaiLieu)d.DanhSachFileDinhKemID=[],null!==d&&void 0!==d&&d.FileDinhKem&&d&&await h(d.FileDinhKem,d);Promise.all(c).then((a=>{m.A.ThemMoiDonThu({...n,LoaiTiepDanID:U}).then((a=>{C(!1),a&&a.data&&1===a.data.Status?(i.Ay.success(a.data.Message),Z(),F(),nn(null===n||void 0===n?void 0:n.isPrint,a.data.Data.XuLyDonID)):i.Ay.error("".concat(a&&a.data?a.data.Message:"L\u1ed7i h\u1ec7 th\u1ed1ng"))}))}))}else m.A.ThemMoiDonThu({...n,LoaiTiepDanID:U}).then((a=>{C(!1),a&&a.data&&1===a.data.Status?(i.Ay.success(a.data.Message),Z(),F(),nn(null===n||void 0===n?void 0:n.isPrint,a.data.Data.XuLyDonID)):i.Ay.error("".concat(a&&a.data?a.data.Message:"L\u1ed7i h\u1ec7 th\u1ed1ng"))}))},onCancel:Z,DanhSachLoaiKhieuTo:J,DanhSachQuocTich:V,DanhSachDanToc:q,DanhSachTinh:W,tableLoading:$,LoaiKhieuTo1ID:e.tabsKey?e.tabsKey:1},j)]}),(0,L.jsx)(S.A,{visible:E,onCancel:an,onCreate:n=>{n.LoaiTiepDanID=U,m.A.TiepDanKhongDen(n).then((n=>{n.data.Status>0?(i.Ay.destroy(),i.Ay.success(n.data.Message),an()):(i.Ay.destroy(),i.Ay.warning(n.data.Message))})).catch((n=>{i.Ay.destroy(),i.Ay.warning(n.toString())}))},onPrint:()=>{R((n=>n+1)),H(!0),an()}},X),(0,L.jsx)(b.A,{visible:O,DanhSachBieuMau:K,onCancel:()=>{H(!1)},LoaiMaIn:g.LoaiMaIn.BienBanTiepCongDan},B),(0,L.jsx)(b.A,{})]})}))}}]);